(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[761],{4141:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/comma-chatting",function(){return t(3762)}])},3762:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return T}});var r=t(5893),s=t(4051),a=t.n(s),i=t(7294),o=function(e){e.data;var n=e.sendMessageClickHandler,t=e.inputFormat,s=e.formatHandler,a=e.enable,o=(0,i.useState)(""),c=o[0],u=o[1],l=(0,i.useState)(""),d=l[0],f=l[1],g=(0,i.useState)(""),p=g[0],h=g[1],b=(0,i.useState)(""),m=b[0],x=b[1];return(0,i.useEffect)((function(){}),[d]),(0,i.useEffect)((function(){if(t){var e=t.Text.toString().indexOf("***");h(t.Text.substring(0,e)),x(t.Text.substring(e).replace("***",""))}}),[t]),(0,r.jsx)("form",{className:"msg-send-form",children:(0,r.jsx)("div",{className:"msg-top-area",children:(0,r.jsxs)("div",{className:"msg-input-box",style:{margin:"auto 0",width:"100%"},children:[(0,r.jsx)("div",{style:Object.assign(t?{display:"block"}:{display:"none"},{height:"54px"}),children:(0,r.jsxs)("div",{style:{background:"#FFFF",borderRadius:"19px",display:"inline-block",padding:"5px"},children:[p,(0,r.jsx)("div",{style:{background:"#4778ff",display:"inline-block",padding:"5px",borderRadius:"19px",color:"#FFFF"},children:d}),m]})}),(0,r.jsx)("textarea",{id:"message",disabled:!a,placeholder:a?"":"\uba54\uc138\uc9c0\ub97c \ubcf4\ub0bc \uc218 \uc5c6\uc5b4\uc694",className:"msg",rows:"1",autoComplete:"off",onInput:function(e){e.target.value?u(" active"):u(""),f(e.target.value)},value:d}),(0,r.jsx)("button",{id:"sendmessage",type:"button",className:"btn-msg-submit"+c,disabled:!a,onClick:function(e){t?(n(p+d+m,t.Link),f(""),u(""),s()):(n(d),f(""),u(""))},children:"\uc804\uc1a1"})]})})})},c=function(e){var n=e.data;return(0,r.jsx)("div",{className:"chat-message-wrap my-chat",children:(0,r.jsx)("div",{className:"msg-bubble-wrap",children:(0,r.jsx)("div",{className:"bubble-box",children:(0,r.jsx)("div",{className:"bubble",children:n.Message[0].Text})})})})},u=t(3012);function l(){var e,n,t=(e=["\n  z-index: 5;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-items: center;\n\n  transition: var(--transition);\n  ","\n  > div {\n    position: absolute;\n    left: 50%;\n    width: 100px;\n    margin-left: -50px;\n  }\n"],n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})));return l=function(){return t},t}var d=u.ZP.div.withConfig({componentId:"sc-72c365a7-0"})(l(),(function(e){return e.rendered?"opacity: 0;pointer-events:none;":"opacity: 1;background-color:rgba(0,0,0,0.03); border-radius: 8px;"})),f=function(e){var n=e.data,t=e.loadingChat;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"chat-message-wrap user-chat",children:[(0,r.jsx)("div",{className:"user-img",children:(0,r.jsx)("a",{href:"#",children:(0,r.jsx)("img",{src:"/images/comma/catmemo.png"})})}),t?(0,r.jsx)("div",{className:"msg-bubble-wrap",children:(0,r.jsx)("div",{className:"bubble-box",children:(0,r.jsx)("div",{className:"bubble",children:(0,r.jsx)(d,{rendered:"false",children:(0,r.jsx)("div",{className:"dot-stage",children:(0,r.jsx)("span",{className:"dot-pulse"})})})})})}):(0,r.jsx)("div",{className:"msg-bubble-wrap",children:n&&n.Message&&n.Message.length>0&&n.Message.map((function(e,n){return(0,r.jsx)("div",{className:"bubble-box",children:(0,r.jsx)("div",{className:"bubble",children:e.Text})},n)}))})]})})};function g(e){var n=e.text,t=e.link,s=e.buttonClickHandler;return(0,r.jsx)("div",{style:{display:"inline-block",marginLeft:"10px",marginBottom:"10px"},children:(0,r.jsx)("button",{style:{border:"1px solid black",borderRadius:"15px",backgroundColor:"white",color:"black",padding:"5px 10px",margin:"0px 0 0 5px",fontSize:"16px",cursor:"pointer"},onClick:s,type:"button",text:n,link:t,children:n})})}var p=t(1163);function h(e){e=null!==e?e:function(e){throw e}(new TypeError("Cannot destructure undefined"));return(0,r.jsx)("div",{style:{display:"inline-block",marginLeft:"10px",marginBottom:"10px"},children:(0,r.jsx)("button",{style:{border:"1px solid black",borderRadius:"15px",backgroundColor:"white",color:"black",padding:"5px 10px",margin:"0px 0 0 5px",fontSize:"16px",cursor:"pointer"},onClick:function(){p.default.replace("/counseling/detail")},type:"button",children:"\ub3cc\uc544\uac00\uae30"})})}function b(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function m(e,n,t,r,s,a,i){try{var o=e[a](i),c=o.value}catch(u){return void t(u)}o.done?n(c):Promise.resolve(c).then(r,s)}function x(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function i(e){m(a,r,s,i,o,"next",e)}function o(e){m(a,r,s,i,o,"throw",e)}i(void 0)}))}}function v(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function j(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){v(e,n,t[n])}))}return e}function y(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return b(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return b(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(){var e,n,t=(e=["\n    *{\n        font-size:14px !important;\n    }\n"],n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})));return w=function(){return t},t}var k=u.ZP.div.withConfig({componentId:"sc-2df7f6e4-0"})(w());function M(){i.useLayoutEffect=i.useEffect;var e=(0,i.useState)([]),n=e[0],t=e[1],s=(0,i.useState)([]),u=s[0],l=s[1],d=(0,i.useState)(""),p=d[0],b=d[1],m=(0,i.useState)(!0),v=m[0],w=m[1],M=(0,i.useState)(!1),N=M[0],T=M[1],E=(0,i.useState)({}),O=E[0],S=E[1],C=(0,i.useRef)(null);(0,i.useEffect)(x(a().mark((function e(){var n,t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/data/chatting.json");case 2:return n=e.sent,e.next=5,n.json();case 5:t=e.sent,(r={}).data=t,S(r);case 9:case"end":return e.stop()}}),e)}))),[]);var F=function(e,r){var s=[];n&&n.length>0&&(s=y(n)).push({Message:[{Text:e,Link:r}],isMine:!0,key:s.length}),t(s)},A=function(e){var r,s=[];n&&n.length>0?0==(s=y(n))[s.length-1].isMine&&0==e.isMine?(r=s[s.length-1].Message).push.apply(r,y(e.Message)):s.push(e):s.push(e);t(s),s[s.length-1].Message[s[s.length-1].Message.length-1].Answers&&l(s[s.length-1].Message[s[s.length-1].Message.length-1].Answers),s[s.length-1].Message[s[s.length-1].Message.length-1].InputFormat&&b(s[s.length-1].Message[s[s.length-1].Message.length-1].InputFormat),s[s.length-1].Message[s[s.length-1].Message.length-1].EndQuestion&&T(!0)};(0,i.useEffect)((function(){A({Message:[{Text:"\uc138\ub9bc\ub2d8\uc740 \uc5b4\ub5a4 \uc0ac\ub78c\uc77c\uae4c\uc694?"},{Text:"\ub54c\ub54c\ub85c \uc790\uae30\ub3c4 \uc790\uae30 \uc790\uc2e0\uc744 \uc54c\uae30 \uc5b4\ub824\uc6cc\uc694"},{Text:"\uadf8\ub798\uc11c \uc900\ube44\ud588\uc5b4\uc694 20\ubb38 20\ub2f5!"},{Text:"\uc9c8\ubb38\uacfc \ub2f5\uc744 \ud558\uba74\uc11c \uc138\ub9bc\ub2d8\uc5d0 \ub300\ud574 \uc54c\uc544\uac00\ubd10\uc694\u2665",Answers:[{Text:"\uadf8\ub798 \uc88b\uc544",Link:1},{Text:"\ub2e4\uc74c\uc5d0 \ud560\ub798",Link:1}]}],isMine:!1})}),[]),(0,i.useEffect)((function(){C.current.scrollTo(0,C.current.scrollHeight)}),[n,u,p,v,N]),(0,i.useEffect)((function(){if(n&&n.length>0&&n[n.length-1].Message[n[n.length-1].Message.length-1].Link){function e(){return t.apply(this,arguments)}function t(){return(t=x(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(1e3);case 2:t=O.data,r=t.find((function(e,t,r){if(n[n.length-1].Message[n[n.length-1].Message.length-1].Link==Number(e.id))return e.Message=e.Question,r[t]})),w(!0),A({Message:[j({Text:r.Question,Answers:r.Answers,Link:r.Link,InputFormat:r.InputFormat},r)],isMine:!1});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}w(!1),e()}}),[n]);var L=function(e){return new Promise((function(n,t){setTimeout(n,e)}))},P=function(e){O&&O.data&&(O.data.find((function(n,t,r){Number(n.id)==Number(e.target.getAttribute("link"))&&F(e.target.getAttribute("text"),Number(e.target.getAttribute("link")))})),l([]))};return(0,i.useLayoutEffect)((function(){var e=function(){C.current.scrollTo(0,C.current.scrollHeight)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),(0,r.jsx)("div",{className:"chat-room-wrap",style:{margin:"0 10px"},children:(0,r.jsx)("div",{className:"container",children:(0,r.jsxs)(k,{className:"cont-wrap",children:[(0,r.jsxs)("div",{className:"chat-content-area",style:p?{height:"calc(100vh - 118px)"}:{height:"calc(100vh - 64px)"},ref:C,children:[n&&n.map((function(e,n){return e.isMine?(0,r.jsx)(c,{data:e},n):(0,r.jsx)(f,{data:e},n)})),u&&u.map((function(e,n){return(0,r.jsx)(g,{text:e.Text,link:e.Link,buttonClickHandler:P},n)})),!v&&(0,r.jsx)(f,{loadingChat:!0}),N&&(0,r.jsx)(h,{})]}),(0,r.jsx)(o,{sendMessageClickHandler:F,formatHandler:function(){b("")},inputFormat:p,enable:u&&0==u.length})]})})})}function N(){return(0,r.jsx)(M,{})}function T(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(N,{})})}}},function(e){e.O(0,[152,774,888,179],(function(){return n=4141,e(e.s=n);var n}));var n=e.O();_N_E=n}]);