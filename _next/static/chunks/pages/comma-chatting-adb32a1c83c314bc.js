(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[761],{5304:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return E}});var s,r=t(9499),a=t(7812),i=t(29),c=t(1383),l=t(7794),o=t.n(l),u=t(7294),d=t(5893),g=function(e){e.data;var n=e.sendMessageClickHandler,t=e.inputFormat,s=e.formatHandler,r=e.enable,a=(0,u.useState)(""),i=a[0],c=a[1],l=(0,u.useState)(""),o=l[0],g=l[1],p=(0,u.useState)(""),f=p[0],h=p[1],x=(0,u.useState)(""),b=x[0],m=x[1];return(0,u.useEffect)((function(){}),[o]),(0,u.useEffect)((function(){if(t){var e=t.Text.toString().indexOf("***");h(t.Text.substring(0,e)),m(t.Text.substring(e).replace("***",""))}}),[t]),(0,d.jsx)("form",{className:"msg-send-form",children:(0,d.jsx)("div",{className:"msg-top-area",children:(0,d.jsxs)("div",{className:"msg-input-box",style:{margin:"auto 0",width:"100%"},children:[(0,d.jsx)("div",{style:Object.assign(t?{display:"block"}:{display:"none"},{height:"54px"}),children:(0,d.jsxs)("div",{style:{background:"#FFFF",borderRadius:"19px",display:"inline-block",padding:"5px"},children:[f,(0,d.jsx)("div",{style:{background:"#4778ff",display:"inline-block",padding:"5px",borderRadius:"19px",color:"#FFFF"},children:o}),b]})}),(0,d.jsx)("textarea",{id:"message",disabled:!r,placeholder:r?"":"\uba54\uc138\uc9c0\ub97c \ubcf4\ub0bc \uc218 \uc5c6\uc5b4\uc694",className:"msg",rows:"1",autoComplete:"off",onInput:function(e){e.target.value?c(" active"):c(""),g(e.target.value)},value:o}),(0,d.jsx)("button",{id:"sendmessage",type:"button",className:"btn-msg-submit"+i,disabled:!r,onClick:function(e){t?(n(f+o+b,t.Link),g(""),c(""),s()):(n(o),g(""),c(""))},children:"\uc804\uc1a1"})]})})})},p=function(e){var n=e.data;return(0,d.jsx)("div",{className:"chat-message-wrap my-chat",children:(0,d.jsx)("div",{className:"msg-bubble-wrap",children:(0,d.jsx)("div",{className:"bubble-box",children:(0,d.jsx)("div",{className:"bubble",children:n.Message[0].Text})})})})},f=t(3012),h=f.ZP.div(s||(s=(0,c.Z)(["\n  z-index: 5;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-items: center;\n\n  transition: var(--transition);\n  ","\n  > div {\n    position: absolute;\n    left: 50%;\n    width: 100px;\n    margin-left: -50px;\n  }\n"])),(function(e){return e.rendered?"opacity: 0;pointer-events:none;":"opacity: 1;background-color:rgba(0,0,0,0.03); border-radius: 8px;"})),x=function(e){var n=e.data,t=e.loadingChat;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"chat-message-wrap user-chat",children:[(0,d.jsx)("div",{className:"user-img",children:(0,d.jsx)("a",{href:"#",children:(0,d.jsx)("img",{src:"/images/comma/catmemo.png"})})}),t?(0,d.jsx)("div",{className:"msg-bubble-wrap",children:(0,d.jsx)("div",{className:"bubble-box",children:(0,d.jsx)("div",{className:"bubble",children:(0,d.jsx)(h,{rendered:!1,children:(0,d.jsx)("div",{className:"dot-stage",children:(0,d.jsx)("span",{className:"dot-pulse"})})})})})}):(0,d.jsx)("div",{className:"msg-bubble-wrap",children:n&&n.Message&&n.Message.length>0&&n.Message.map((function(e,n){return(0,d.jsx)("div",{className:"bubble-box",children:(0,d.jsx)("div",{className:"bubble",children:e.Text})},n)}))})]})})};function b(e){var n=e.text,t=e.link,s=e.buttonClickHandler;return(0,d.jsx)("div",{style:{display:"inline-block",marginLeft:"10px",marginBottom:"10px"},children:(0,d.jsx)("button",{style:{border:"1px solid black",borderRadius:"15px",backgroundColor:"white",color:"black",padding:"5px 10px",margin:"0px 0 0 5px",fontSize:"16px",cursor:"pointer"},onClick:s,type:"button",text:n,link:t,children:n})})}var m,v=t(7191),j=t(1163);function k(e){(0,v.Z)(e);return(0,d.jsx)("div",{style:{display:"inline-block",marginLeft:"10px",marginBottom:"10px"},children:(0,d.jsx)("button",{style:{border:"1px solid black",borderRadius:"15px",backgroundColor:"white",color:"black",padding:"5px 10px",margin:"0px 0 0 5px",fontSize:"16px",cursor:"pointer"},onClick:function(){j.default.replace("/counseling/detail")},type:"button",children:"\ub3cc\uc544\uac00\uae30"})})}function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function w(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}u.useLayoutEffect=u.useEffect;var M=f.ZP.div(m||(m=(0,c.Z)(["\n    *{\n        font-size:14px !important;\n    }\n"])));function N(){var e=(0,u.useState)([]),n=e[0],t=e[1],s=(0,u.useState)([]),r=s[0],c=s[1],l=(0,u.useState)(""),f=l[0],h=l[1],m=(0,u.useState)(!0),v=m[0],j=m[1],y=(0,u.useState)(!1),N=y[0],O=y[1],E=(0,u.useState)({}),T=E[0],F=E[1],L=(0,u.useRef)(null);(0,u.useEffect)((0,i.Z)(o().mark((function e(){var n,t,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/data/chatting.json");case 2:return n=e.sent,e.next=5,n.json();case 5:t=e.sent,(s={}).data=t,F(s);case 9:case"end":return e.stop()}}),e)}))),[]);var S=function(e,s){var r=[];n&&n.length>0&&(r=(0,a.Z)(n)).push({Message:[{Text:e,Link:s}],isMine:!0,key:r.length}),t(r)},C=function(e){var s,r=[];n&&n.length>0?0==(r=(0,a.Z)(n))[r.length-1].isMine&&0==e.isMine?(s=r[r.length-1].Message).push.apply(s,(0,a.Z)(e.Message)):r.push(e):r.push(e);t(r),r[r.length-1].Message[r[r.length-1].Message.length-1].Answers&&c(r[r.length-1].Message[r[r.length-1].Message.length-1].Answers),r[r.length-1].Message[r[r.length-1].Message.length-1].InputFormat&&h(r[r.length-1].Message[r[r.length-1].Message.length-1].InputFormat),r[r.length-1].Message[r[r.length-1].Message.length-1].EndQuestion&&O(!0)};(0,u.useEffect)((function(){C({Message:[{Text:"\uc138\ub9bc\ub2d8\uc740 \uc5b4\ub5a4 \uc0ac\ub78c\uc77c\uae4c\uc694?"},{Text:"\ub54c\ub54c\ub85c \uc790\uae30\ub3c4 \uc790\uae30 \uc790\uc2e0\uc744 \uc54c\uae30 \uc5b4\ub824\uc6cc\uc694"},{Text:"\uadf8\ub798\uc11c \uc900\ube44\ud588\uc5b4\uc694 20\ubb38 20\ub2f5!"},{Text:"\uc9c8\ubb38\uacfc \ub2f5\uc744 \ud558\uba74\uc11c \uc138\ub9bc\ub2d8\uc5d0 \ub300\ud574 \uc54c\uc544\uac00\ubd10\uc694\u2665",Answers:[{Text:"\uadf8\ub798 \uc88b\uc544",Link:1},{Text:"\ub2e4\uc74c\uc5d0 \ud560\ub798",Link:1}]}],isMine:!1})}),[]),(0,u.useEffect)((function(){L.current.scrollTo(0,L.current.scrollHeight)}),[n,r,f,v,N]),(0,u.useEffect)((function(){if(n&&n.length>0&&n[n.length-1].Message[n[n.length-1].Message.length-1].Link){var e=function(){var e=(0,i.Z)(o().mark((function e(){var t,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(1e3);case 2:t=T.data,s=t.find((function(e,t,s){if(n[n.length-1].Message[n[n.length-1].Message.length-1].Link==Number(e.id))return e.Message=e.Question,s[t]})),j(!0),C({Message:[w({Text:s.Question,Answers:s.Answers,Link:s.Link,InputFormat:s.InputFormat},s)],isMine:!1});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();j(!1),e()}}),[n]);var P=function(e){return new Promise((function(n,t){setTimeout(n,e)}))},_=function(e){T&&T.data&&(T.data.find((function(n,t,s){Number(n.id)==Number(e.target.getAttribute("link"))&&S(e.target.getAttribute("text"),Number(e.target.getAttribute("link")))})),c([]))};return(0,u.useLayoutEffect)((function(){var e=function(){L.current.scrollTo(0,L.current.scrollHeight)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),(0,d.jsx)("div",{className:"chat-room-wrap",style:{margin:"0 10px"},children:(0,d.jsx)("div",{className:"container",children:(0,d.jsxs)(M,{className:"cont-wrap",children:[(0,d.jsxs)("div",{className:"chat-content-area",style:f?{height:"calc(100vh - 118px)"}:{height:"calc(100vh - 64px)"},ref:L,children:[n&&n.map((function(e,n){return e.isMine?(0,d.jsx)(p,{data:e},n):(0,d.jsx)(x,{data:e},n)})),r&&r.map((function(e,n){return(0,d.jsx)(b,{text:e.Text,link:e.Link,buttonClickHandler:_},n)})),!v&&(0,d.jsx)(x,{loadingChat:!0},v),N&&(0,d.jsx)(k,{})]}),(0,d.jsx)(g,{sendMessageClickHandler:S,formatHandler:function(){h("")},inputFormat:f,enable:r&&0==r.length})]})})})}function O(){return(0,d.jsx)(N,{})}function E(){return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(O,{})})}},4141:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/comma-chatting",function(){return t(5304)}])}},function(e){e.O(0,[378,774,888,179],(function(){return n=4141,e(e.s=n);var n}));var n=e.O();_N_E=n}]);